drop database if exists condorcet_event;
select count(*) from information_schema.schemata where schema_name = 'condorcet_event';
create database condorcet_event;
use condorcet_event;
create table int_variable (
    id int not null auto_increment,
    name varchar(255) not null unique,
    value int not null,
    primary key(id)
);
create table event (
    id int not null auto_increment,
    `when` datetime(6) not null,
    type varchar(255) not null,
    text text not null,
    primary key(id)
);
insert into event (`when`, type, text)
values ('2021-02-03 20:16:30.928376', 'AddUser', '{"name":"Alice","email":"alice@email.com","salt":"01298967-e68a-4f65-97f5-8b31b1f94a75","hash":"5DD7625619EB3DBB0DD1BD404AA1F4BC71B9B34E1A3C1109725631BFF959C4A7","role":"OWNER"}')
;
select value
from int_variable
where name = 'last-synced'
;
insert into int_variable (name, value)
values ('last-synced', 0)
;
select value
from int_variable
where name = 'last-synced'
;
update int_variable
set value = 1
where name = 'last-synced'
;
insert into event (`when`, type, text)
values ('2021-02-03 20:16:30.992934', 'AddUser', '{"name":"Bob","email":"bob@email.com","salt":"738cdf72-3487-4f6a-a8a7-438d15f5e22d","hash":"AA60D57CE55FE26F5820EADA7A62A1BB91B80C667CC4E6163D19ACE32B7E2C68","role":"UNASSIGNED"}')
;
select value
from int_variable
where name = 'last-synced'
;
update int_variable
set value = 2
where name = 'last-synced'
;
insert into event (`when`, type, text)
values ('2021-02-03 20:16:31.003057', 'AddUser', '{"name":"Carol","email":"carol@email.com","salt":"f38296e8-882d-4a22-a64c-a88660981dd6","hash":"46C1FDAFECC2E858C91B34F75E41622DE8D70B67BABBEA32CD4F3654BA35D2F2","role":"UNASSIGNED"}')
;
select value
from int_variable
where name = 'last-synced'
;
update int_variable
set value = 3
where name = 'last-synced'
;
insert into event (`when`, type, text)
values ('2021-02-03 20:16:31.013128', 'AddUser', '{"name":"Dave","email":"dave@email.com","salt":"cb33f280-89d0-4dc6-a01f-453aa87fcafb","hash":"C7362093884945D1657B57AD3ECC7DE449D60D7AA78246F31B12D579A220D2B2","role":"UNASSIGNED"}')
;
select value
from int_variable
where name = 'last-synced'
;
update int_variable
set value = 4
where name = 'last-synced'
;
